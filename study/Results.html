{% extends "global/Page.html" %}
{% load otree %}

{% block title %}
    Results
{% endblock %}

{% block content %}

    <p>Your performance in this part was {{ player.performance }}.</p>


    {% next_button %}


{% endblock %}

{% block scripts %}
<script>

// -------- TAB FLASH REMINDER ON RESULTS PAGE --------

// Prevent URL title from flashing — use nice page name instead
document.title = "Results";
let originalTitle = document.title;

// Flash the tab title until user views the tab.
document.addEventListener("DOMContentLoaded", () => {

    let originalTitle = document.title;
    const FLASH_TEXT = "⏰ Time's up!";
    let flashInterval = null;

    // Start flashing if tab is inactive on load
    function startFlashing() {
        if (flashInterval !== null) return;
        flashInterval = setInterval(() => {
            document.title =
                document.title === originalTitle ? FLASH_TEXT : originalTitle;
        }, 800);
    }

    function stopFlashing() {
        if (flashInterval !== null) {
            clearInterval(flashInterval);
            flashInterval = null;
        }
        document.title = originalTitle;
    }

    // If hidden at load → start immediately
    if (document.visibilityState === "hidden") {
        startFlashing();
    }

    // When user activates the tab → stop forever
    document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === "visible") {
            stopFlashing();
        }
    });
});

</script>
{% endblock %}